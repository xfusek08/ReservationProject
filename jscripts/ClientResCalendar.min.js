function LoadTerms(e,t,r){var a=e.getMonth(),n=new Date(e.getFullYear(),a-1,1),o=new Date(e.getFullYear(),a+3,1);$.ajax({url:location.protocol+"//"+location.host+location.pathname,type:"POST",async:t,data:"ajax=true&type=getterms&fromdate="+DateToStr(n)+"&todate="+DateToStr(o),success:function(e){var a=$(TermsXMLHandle);$(e).find("month").each(function(){var e=a.find('month[monthnum="'+$(this).attr("monthnum")+'"]');e.length>0?e.html($(this).html()):$('<month monthnum="'+$(this).attr("monthnum")+'">'+$(this).html()+"</month>").appendTo(a)}),TermsXMLHandle="<months>"+a.html()+"</months>",t&&$("#datepicker").datepicker("refresh"),"function"==typeof r&&r()}})}function InitDatePicker(){$.datepicker.regional.cs={closeText:"Cerrar",prevText:"<",nextText:">",currentText:"Hoy",monthNames:["Leden","Únor","Březen","Duben","Květen","Červen","Červenec","Srpen","Září","Říjen","Listopad","Prosinec"],monthNamesShort:["Le","Ún","Bř","Du","Kv","Čn","Čc","Sr","Zá","Ří","Li","Pr"],dayNames:["Neděle","Pondělí","Úterý","Středa","Čtvrtek","Pátek","Sobota"],dayNamesShort:["Ne","Po","Út","St","Čt","Pá","So"],dayNamesMin:["Ne","Po","Út","St","Čt","Pá","So"],weekHeader:"Sm",dateFormat:"dd.mm.yy",firstDay:1,isRTL:!0,showMonthAfterYear:!1,yearSuffix:"",showOtherMonths:!0,selectOtherMonths:!0,numberOfMonths:2,stepMonths:1},$.datepicker.setDefaults($.datepicker.regional.cs),$("#datepicker").datepicker({beforeShowDay:function(e){return result=new Array(!1,""),LoadDayData(result,$(this),e),result},onSelect:function(e,t){DateSelect($(this),e),t.drawMonth=drawmonth,$(".daytermview").find(".dtr-content").css({maxHeight:$(".ui-datepicker-group table tbody").outerHeight()-10+"px"})},onChangeMonthYear:function(e,t){$(".daytermview").hide(),$("input[name=c_selterm]").remove();var r=new Date(e,t-1,1);$(this).datepicker("setDate",r),LoadTerms(r,!0),drawmonth=t-1}}).find(".ui-state-active").removeClass("ui-state-active")}function LoadDayData(e,t,r){var a=null;a=$(TermsXMLHandle).find('day[date="'+DateToStr(r)+'"]');var n=new Date;n.setHours(0,0,0,0),a.length>0&&r>=n&&(e[0]=!0)}function DateSelect(e,t){e.datepicker("setDate",t);var r=$(".daytermview");if(r.css("display","table-cell"),r.attr("date")!=t){$("input[name=c_selterm]").remove(),r.attr("date",t),r.find(".dtr-conn .dtr-header").text($.datepicker.formatDate("DD",StrToDate(t))+" "+t);var a=r.find(".dtr-conn .dtr-content");a.empty();var n="";$(TermsXMLHandle).find('day[date="'+t+'"]').find("term").each(function(){n='<div class="dtr-day-term" pk="'+$(this).attr("pk")+'">'+$(this).attr("time")+"</div>",$(n).appendTo(a)}),a.on("click",".dtr-day-term",function(){SelectTerm(a,$(this).attr("pk"))})}}function SelectTerm(e,t){e.find(".dtr-state-selected").removeClass("dtr-state-selected"),e.find(".dtr-day-term[pk="+t+"]").addClass("dtr-state-selected"),$("input[name=c_selterm]").remove();var r='<input type="hidden" name="c_selterm" value="'+t+'"/>';$(r).appendTo($("form"))}function CheckLoadedMonth(e,t){if(!($(TermsXMLHandle).find('month[monthnum="'+t+'"]').length>0)){var r=$('<div class="spinner"><img class="img-spinner" src="resources/images/ajax-loader.gif"/></div>');r.css({top:e.position().top+e.outerHeight()/2-2+"px",left:e.position().left+e.outerWidth()/2-23+"px"}),r.appendTo(e.find(".ui-datepicker"))}}var TermsXMLHandle="<months></months>",drawmonth=0;$(document).ready(function(){drawmonth=(new Date).getMonth(),InitDatePicker(),LoadTerms(new Date,!0,function(){if($(".termchoose").attr("termpk").length>0&&$(".termchoose").attr("termpk")>0){var e=$(TermsXMLHandle).find('term[pk="'+$(".termchoose").attr("termpk")+'"]').closest("day").attr("date");e&&(DateSelect($("#datepicker"),e),SelectTerm($(".daytermview"),$(".termchoose").attr("termpk")))}}),setInterval(function(){LoadTerms($("#datepicker").datepicker("getDate"),!0)},3e4),$(".res-form-requrie").on("keyup","input[type=text]",function(){$(this).addClass("res-form-fadeoutcolor"),setTimeout(function(){$(this).closest(".res-form-requrie").removeClass("res-form-requrie"),$(this).removeClass("res-form-fadeoutcolor")},400)})});